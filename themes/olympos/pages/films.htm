title = "Films"
url = "/films/:page?"
layout = "default"
is_hidden = 0

==
<?

use Webmaster\Movies\Models\Movie;

function onStart()
{
    // PHP Block
    // je vais utiliser les functions de création de requête de Laracel
    // $this['movies'] = Movie::get();
    // Ici je récupère tous les film et je met la pagination à 1 par page
    $this['movies'] = Movie::orderBy('year', 'desc')->paginate(2);
    // dd($this['movies']);
}
?>
==

<ul class="record-list">
    {% for movie in movies %}
    <li>
        <h3>
            <a href="/projetTestOctoberCMS/films/film/{{ movie.slug}}">
                {{ movie.name}} - {{ movie.year }}
            </a>
        </h3>
        {{ html_limit(movie.description, 150)|raw }}
    </li>
    {% else %}
    <li class="no-data">Il n'y a pas de films</li>
    {% endfor %}
</ul>

<div>{{ movies.render|raw }}</div>